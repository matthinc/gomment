#+startup: indent
* gomment - A lightweight commenting system using Go, SQLite and Vanilla JS
[[https://api.travis-ci.com/matthinc/gomment.svg?branch=master]]
[[https://img.shields.io/docker/image-size/matthinc/gomment.svg]]

**Demo:**

** Why gomment?
- *Lighweight* - The docker image is < 30MB, the JavaScript file is < 20kB (gzip < 5kB)
- *Fast* - Native performance thanks to go
- *Frontend-agnostic* - Use the default JavaScript frontend or build your own using the *gomment JSON API*
- *Container-first* - gomment was built with *Docker* in mind from the first second
- *Portable* - gomment uses a single SQLite file as its database

** Contributing
All contributions to the project are welcome. Make sure to read the project philosophy before submitting your contribution.

*** Project Philosophy
- Store the data read-optimized - Sacrifice performance when inserting comments
- Not everything is a ressource - We use a simple JSON HTTP API, not REST
- JavaScript: Keep it vanilla - No JavaScript build pipeline, just static analyzers
- The 3rd NF can be violated - Traversing trees in DBMS is expensive, keep it fast
- System Tests > Integration Tests > Unit Tests - Unit-test the hard things

*** Conventions and Standards
- CSS identifier naming: [[http://getbem.com/naming/][BEM]]
- JS type checking: Typescript

** Embedding

#+BEGIN_SRC html
<!-- gomment will be injected into this element -->
<div id="comments"></div>

<script type="module">
 import {Gomment} from './gomment.js';

 new Gomment({
     apiURL: '/',
     thread: 0
 }).injectInto('#comments');
</script>
#+END_SRC

** Progress
Gomment is currently WIP and not ready for production.

*** Version 1.0.0 Milestone
Checklist for 1.0.0 release:
- [X] Newest Branch First (NBF) sorting
- [X] Newest Sibling First (NSF) sorting
- [ ] Comment administration panel
- [ ] Working system tests (API)
- [ ] Database migration system
- [ ] Detailed installation documentation (nginx, ...)
- [ ] Deployed Live-Demo
- [ ] Integrate static assets in go binary
- [ ] SemVer Documentation

*** Version 1.1.0 Milestone
- [ ] Static non-JS Preview
- [ ] Pluggable system for notification

** Misc TODOs
*** TODO Set trusted cookies in config file
    - https://github.com/gin-gonic/gin/blob/master/README.md#dont-trust-all-proxies

*** TODO Restrict GOMMENT_SID cookie path to X-Forward-Prefix

*** TODO Show error when loading comments fails

*** TODO Make all IDs int64

*** TODO Input validation non-empty text

*** TODO Loading animation to prevent multiple user requests

*** TODO use proper go / gingnic contexts

*** TODO Configurable server-side limits depth/limit

*** TODO Clean up nbf tests

*** TODO XSF: morecomments only with newestcreatedat
